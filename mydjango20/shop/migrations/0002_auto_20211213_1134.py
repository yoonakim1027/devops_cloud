# Generated by Django 3.2.10 on 2021-12-13 02:34

# [ë©í„°ì¥°ìŠˆğŸ¦–] [ì˜¤ì „ 11:45] https://docs.djangoproject.com/ko/3.2/topics/migrations/

import django.core.validators
from django.db import migrations, models
import django.db.models.deletion

# ì ˆëŒ€ ìƒë‹¨ì—ì„œ from shop.models. import Categoryë¥¼ í•˜ì§€ ë§ˆì‹œê³ 
# ë§ˆì´ê·¸ë ˆì´ì…˜ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ appsë¥¼ í†µí•´ ëª¨ë¸ í´ë˜ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”
# ë°‘ì—ì²˜ëŸ¼!!


# ì¹´í…Œê³ ë¦¬ í…Œì´ë¸”ì´ ë§Œë“¤ì–´ì§€ê³  ë‚˜ì„œ ìˆ˜í–‰ (ì •ë°©í–¥)
def create_dummy_category(apps,schema_editor):
    Category = apps.get_model("shop","Category") # model class
    Category.objects.create(name="dummy") # pk :1

# ì¹´í…Œê³ ë¦¬ í…Œì´ë¸”ì´ ì‚­ì œë˜ê³  ë‚˜ì„œ ìˆ˜í–‰ (ì—­ë°©í–¥)
def delete_dummy_category(apps,schema_editor):
    Category = apps.get_model("shop", "Category")  # model class
    Category.objects.all().delete()

class Migration(migrations.Migration):

    dependencies = [
        ('shop', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Category',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=100, unique=True)),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.AlterModelOptions(
            name='review',
            options={'verbose_name': 'ë¦¬ë·°', 'verbose_name_plural': 'ë¦¬ë·° ëª©ë¡'},
        ),
        migrations.AlterModelOptions(
            name='shop',
            options={'verbose_name': 'ìƒì ', 'verbose_name_plural': 'ìƒì  ëª©ë¡'},
        ),
        migrations.AlterModelOptions(
            name='tag',
            options={'verbose_name': 'íƒœê·¸', 'verbose_name_plural': 'íƒœê·¸ ëª©ë¡'},
        ),
        migrations.AddField(
            model_name='shop',
            name='photo',
            field=models.ImageField(default=1, upload_to='diary/post/%Y/%M/%d', verbose_name='ì—…ì²´ ì‚¬ì§„'),
            preserve_default=False,
        ),
        migrations.AlterField(
            model_name='review',
            name='author_name',
            field=models.CharField(max_length=20, verbose_name='ì‘ì„±ì ì´ë¦„'),
        ),
        migrations.AlterField(
            model_name='review',
            name='message',
            field=models.TextField(verbose_name='ë¦¬ë·°'),
        ),
        migrations.AlterField(
            model_name='shop',
            name='description',
            field=models.TextField(blank=True, verbose_name='ì—…ì²´ ì„¤ëª…'),
        ),
        migrations.AlterField(
            model_name='shop',
            name='name',
            field=models.CharField(db_index=True, max_length=100, verbose_name='ì—…ì²´ ëª…'),
        ),
        migrations.AlterField(
            model_name='shop',
            name='tag_set',
            field=models.ManyToManyField(blank=True, to='shop.Tag', verbose_name='í•´ì‹œíƒœê·¸'),
        ),
        migrations.AlterField(
            model_name='shop',
            name='telephone',
            field=models.CharField(help_text='ì…ë ¥ ì˜ˆ) 042-1234-1234', max_length=14, validators=[django.core.validators.RegexValidator('^\\d{3}-?\\d{4}-?\\d{4}$', message='ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.')], verbose_name='ì—…ì²´ ì „í™”ë²ˆí˜¸'),
        ),
        migrations.AddField(
            model_name='shop',
            name='category',
            field=models.ForeignKey(default=1, on_delete=django.db.models.deletion.CASCADE, to='shop.category'),
            preserve_default=False,
        ),

        migrations.RunPython(create_dummy_category,delete_dummy_category)
    ]

    # ì¹´í…Œê³ ë¦¬ë¼ëŠ” ì´ë¦„ì˜ ëª¨ë¸ì„ ë§Œë“¤ê³  makemigrations
    # ì¹´í…Œê³ ë¦¬ ëª¨ë¸ ìƒì„±ì— ëŒ€í•œ migraion íŒŒì¼ ìˆ˜ì…©
    # create_dummy (ì •ë°©í–¥)
    # delete_dummy (ì—­ë°©í–¥)
    # operationsì€ í•­ìƒ ìˆœì„œê°€ ìˆìŒ



